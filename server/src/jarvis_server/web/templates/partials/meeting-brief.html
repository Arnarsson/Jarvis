<!-- Meeting brief partial -->
{% if brief %}
<div class="meeting-brief">
    <!-- Event info header -->
    <div class="brief-header">
        <div class="brief-event-info">
            <div class="brief-time">
                <svg class="h-5 w-5 text-gray-400" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
                <span>{{ event.start_time.strftime('%A, %B %d at %H:%M') }}</span>
            </div>
            {% if event.location %}
            <div class="brief-location">
                <svg class="h-5 w-5 text-gray-400" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M15 10.5a3 3 0 11-6 0 3 3 0 016 0z" />
                    <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1115 0z" />
                </svg>
                <span>{{ event.location }}</span>
            </div>
            {% endif %}
            {% if event.meeting_link %}
            <div class="brief-meeting-link">
                <svg class="h-5 w-5 text-gray-400" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                    <path stroke-linecap="round" d="M15.75 10.5l4.72-4.72a.75.75 0 011.28.53v11.38a.75.75 0 01-1.28.53l-4.72-4.72M4.5 18.75h9a2.25 2.25 0 002.25-2.25v-9a2.25 2.25 0 00-2.25-2.25h-9A2.25 2.25 0 002.25 7.5v9a2.25 2.25 0 002.25 2.25z" />
                </svg>
                <a href="{{ event.meeting_link }}" target="_blank" class="text-indigo-600 hover:text-indigo-500 hover:underline">
                    Join video call
                </a>
            </div>
            {% endif %}
        </div>
    </div>

    <!-- Attendees section -->
    {% if event.attendees %}
    <div class="brief-section">
        <h4 class="brief-section-title">Attendees ({{ event.attendees|length }})</h4>
        <div class="brief-attendees-list">
            {% for attendee in event.attendees %}
            <div class="brief-attendee">
                <div class="brief-attendee-avatar">{{ attendee.initials }}</div>
                <div class="brief-attendee-info">
                    <span class="brief-attendee-name">{{ attendee.display_name or attendee.email }}</span>
                    {% if attendee.organizer %}
                    <span class="brief-attendee-badge">Organizer</span>
                    {% endif %}
                    {% if attendee.response_status == 'accepted' %}
                    <span class="brief-attendee-status accepted">Accepted</span>
                    {% elif attendee.response_status == 'declined' %}
                    <span class="brief-attendee-status declined">Declined</span>
                    {% elif attendee.response_status == 'tentative' %}
                    <span class="brief-attendee-status tentative">Maybe</span>
                    {% endif %}
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
    {% endif %}

    <!-- Brief content -->
    <div class="brief-section">
        <h4 class="brief-section-title">
            Meeting Brief
            {% if was_cached %}
            <span class="brief-cache-badge">Cached</span>
            {% endif %}
        </h4>
        <div class="brief-content prose prose-sm">
            {{ brief_html|safe }}
        </div>
    </div>

    <!-- Regenerate button -->
    <div class="brief-actions">
        <button type="button"
                hx-post="/api/meetings/brief/{{ event.id }}?force_regenerate=true"
                hx-target="#brief-content"
                hx-swap="innerHTML"
                hx-indicator="#brief-loading"
                class="brief-regenerate-btn">
            <svg class="h-4 w-4 mr-2" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99" />
            </svg>
            Regenerate Brief
        </button>
        <div id="brief-loading" class="htmx-indicator ml-2">
            <svg class="h-5 w-5 animate-spin text-indigo-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
            </svg>
        </div>
    </div>
</div>
{% elif needs_generation %}
<div class="brief-generate">
    <div class="text-center py-8">
        <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" d="M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09zM18.259 8.715L18 9.75l-.259-1.035a3.375 3.375 0 00-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 002.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 002.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 00-2.456 2.456z" />
        </svg>
        <h3 class="mt-4 text-sm font-medium text-gray-900">No brief generated yet</h3>
        <p class="mt-2 text-sm text-gray-500">Generate an AI-powered brief with relevant context for this meeting.</p>
        <button type="button"
                hx-post="/api/meetings/brief/{{ event.id }}"
                hx-target="#brief-content"
                hx-swap="innerHTML"
                hx-indicator="#generate-loading"
                class="mt-4 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
            <svg class="h-4 w-4 mr-2" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="M9.813 15.904L9 18.75l-.813-2.846a4.5 4.5 0 00-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 003.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 003.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 00-3.09 3.09z" />
            </svg>
            Generate Brief
        </button>
        <div id="generate-loading" class="htmx-indicator mt-4">
            <div class="flex items-center justify-center text-sm text-gray-500">
                <svg class="h-5 w-5 animate-spin text-indigo-600 mr-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                </svg>
                Generating brief...
            </div>
        </div>
    </div>
</div>
{% else %}
<div class="empty-state">
    <svg class="empty-state-icon" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
        <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m9-.75a9 9 0 11-18 0 9 9 0 0118 0zm-9 3.75h.008v.008H12v-.008z" />
    </svg>
    <p class="empty-state-title">Event not found</p>
    <p class="empty-state-description">Unable to load meeting brief</p>
</div>
{% endif %}

<style>
/* Meeting brief styles */
.meeting-brief {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
}

.brief-header {
    padding-bottom: 1rem;
    border-bottom: 1px solid #e5e7eb;
}

.brief-event-info {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.brief-time,
.brief-location,
.brief-meeting-link {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.875rem;
    color: #4b5563;
}

.brief-section {
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
}

.brief-section-title {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: 0.875rem;
    font-weight: 600;
    color: #111827;
}

.brief-cache-badge {
    font-size: 0.625rem;
    font-weight: 500;
    padding: 0.125rem 0.375rem;
    border-radius: 9999px;
    background-color: #f3f4f6;
    color: #6b7280;
}

.brief-attendees-list {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
}

.brief-attendee {
    display: flex;
    align-items: center;
    gap: 0.75rem;
}

.brief-attendee-avatar {
    flex-shrink: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 2rem;
    height: 2rem;
    font-size: 0.625rem;
    font-weight: 600;
    color: #ffffff;
    background-color: #6366f1;
    border-radius: 9999px;
}

.brief-attendee-info {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    flex-wrap: wrap;
}

.brief-attendee-name {
    font-size: 0.875rem;
    color: #374151;
}

.brief-attendee-badge {
    font-size: 0.625rem;
    font-weight: 500;
    padding: 0.125rem 0.375rem;
    border-radius: 9999px;
    background-color: #fef3c7;
    color: #92400e;
}

.brief-attendee-status {
    font-size: 0.625rem;
    font-weight: 500;
    padding: 0.125rem 0.375rem;
    border-radius: 9999px;
}

.brief-attendee-status.accepted {
    background-color: #d1fae5;
    color: #065f46;
}

.brief-attendee-status.declined {
    background-color: #fee2e2;
    color: #991b1b;
}

.brief-attendee-status.tentative {
    background-color: #e0e7ff;
    color: #3730a3;
}

.brief-content {
    font-size: 0.875rem;
    line-height: 1.625;
    color: #374151;
}

.brief-content p {
    margin-bottom: 0.75rem;
}

.brief-content ul,
.brief-content ol {
    margin-bottom: 0.75rem;
    padding-left: 1.5rem;
}

.brief-content li {
    margin-bottom: 0.25rem;
}

.brief-content h3 {
    font-size: 0.875rem;
    font-weight: 600;
    color: #111827;
    margin-top: 1rem;
    margin-bottom: 0.5rem;
}

.brief-actions {
    display: flex;
    align-items: center;
    padding-top: 1rem;
    border-top: 1px solid #e5e7eb;
}

.brief-regenerate-btn {
    display: inline-flex;
    align-items: center;
    padding: 0.5rem 1rem;
    font-size: 0.875rem;
    font-weight: 500;
    color: #6b7280;
    background-color: #ffffff;
    border: 1px solid #d1d5db;
    border-radius: 0.375rem;
    cursor: pointer;
    transition: background-color 0.15s ease, color 0.15s ease;
}

.brief-regenerate-btn:hover {
    background-color: #f9fafb;
    color: #111827;
}
</style>
