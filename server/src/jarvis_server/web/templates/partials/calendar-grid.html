<!-- Calendar month grid partial -->
<div class="calendar-month">
    <!-- Month navigation -->
    <div class="flex items-center justify-between mb-4">
        <button type="button"
                hx-get="/api/web/calendar/month?year={{ prev_year }}&month={{ prev_month }}"
                hx-target="#calendar-grid"
                hx-swap="innerHTML"
                class="p-2 rounded-lg hover:bg-gray-100 text-gray-600 hover:text-gray-900">
            <svg class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="M15.75 19.5L8.25 12l7.5-7.5" />
            </svg>
        </button>
        <h2 class="text-lg font-semibold text-gray-900">{{ month_name }} {{ year }}</h2>
        <button type="button"
                hx-get="/api/web/calendar/month?year={{ next_year }}&month={{ next_month }}"
                hx-target="#calendar-grid"
                hx-swap="innerHTML"
                class="p-2 rounded-lg hover:bg-gray-100 text-gray-600 hover:text-gray-900">
            <svg class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="M8.25 4.5l7.5 7.5-7.5 7.5" />
            </svg>
        </button>
    </div>

    <!-- Day headers -->
    <div class="grid grid-cols-7 gap-px bg-gray-200 rounded-t-lg overflow-hidden">
        {% for day in ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'] %}
        <div class="bg-gray-50 py-2 text-center text-xs font-semibold text-gray-700">{{ day }}</div>
        {% endfor %}
    </div>

    <!-- Calendar days -->
    <div class="grid grid-cols-7 gap-px bg-gray-200 rounded-b-lg overflow-hidden">
        {% for week in weeks %}
            {% for day in week %}
            <div class="calendar-day {% if day.is_today %}calendar-day-today{% endif %} {% if day.is_current_month %}calendar-day-current{% else %}calendar-day-other{% endif %} {% if day.has_events %}calendar-day-has-events{% endif %}"
                 {% if day.date %}
                 hx-get="/api/web/calendar/events?date={{ day.date }}"
                 hx-target="#events-list"
                 hx-swap="innerHTML"
                 @click="selectDate('{{ day.date }}', '{{ day.label }}')"
                 {% endif %}>
                <span class="calendar-day-number {% if day.is_today %}calendar-day-number-today{% endif %}">
                    {{ day.day }}
                </span>
                {% if day.event_count > 0 %}
                <div class="calendar-day-events">
                    {% if day.event_count <= 3 %}
                        {% for event in day.events[:3] %}
                        <div class="calendar-event-dot" title="{{ event.summary }}">
                            <span class="calendar-event-title">{{ event.summary|truncate(15) }}</span>
                        </div>
                        {% endfor %}
                    {% else %}
                        {% for event in day.events[:2] %}
                        <div class="calendar-event-dot" title="{{ event.summary }}">
                            <span class="calendar-event-title">{{ event.summary|truncate(15) }}</span>
                        </div>
                        {% endfor %}
                        <div class="calendar-event-more">+{{ day.event_count - 2 }} more</div>
                    {% endif %}
                </div>
                {% endif %}
            </div>
            {% endfor %}
        {% endfor %}
    </div>
</div>

<style>
/* Calendar-specific styles */
.calendar-day {
    min-height: 80px;
    padding: 0.5rem;
    background-color: #ffffff;
    cursor: pointer;
    transition: background-color 0.15s ease;
}

.calendar-day:hover {
    background-color: #f9fafb;
}

.calendar-day-other {
    background-color: #f9fafb;
}

.calendar-day-other .calendar-day-number {
    color: #9ca3af;
}

.calendar-day-today {
    background-color: #eef2ff;
}

.calendar-day-number {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    font-size: 0.875rem;
    font-weight: 500;
    color: #374151;
}

.calendar-day-number-today {
    width: 1.75rem;
    height: 1.75rem;
    border-radius: 9999px;
    background-color: #4f46e5;
    color: #ffffff;
}

.calendar-day-events {
    margin-top: 0.25rem;
    display: flex;
    flex-direction: column;
    gap: 0.125rem;
}

.calendar-event-dot {
    display: flex;
    align-items: center;
    gap: 0.25rem;
    padding: 0.125rem 0.25rem;
    background-color: #e0e7ff;
    border-radius: 0.25rem;
    overflow: hidden;
}

.calendar-event-dot::before {
    content: '';
    flex-shrink: 0;
    width: 0.375rem;
    height: 0.375rem;
    border-radius: 9999px;
    background-color: #4f46e5;
}

.calendar-event-title {
    font-size: 0.625rem;
    color: #4338ca;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.calendar-event-more {
    font-size: 0.625rem;
    color: #6b7280;
    padding-left: 0.25rem;
}

/* Responsive adjustments */
@media (max-width: 640px) {
    .calendar-day {
        min-height: 50px;
        padding: 0.25rem;
    }

    .calendar-event-title {
        display: none;
    }

    .calendar-event-dot {
        width: 0.5rem;
        height: 0.5rem;
        padding: 0;
        border-radius: 9999px;
    }

    .calendar-event-more {
        display: none;
    }
}
</style>
