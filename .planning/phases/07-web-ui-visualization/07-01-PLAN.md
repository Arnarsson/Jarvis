---
phase: 07-web-ui-visualization
plan: 01
type: execute
wave: 1
depends_on: []
autonomous: true

must_haves:
  truths:
    - "Web UI is accessible at http://localhost:8000/"
    - "Base template includes HTMX, Alpine.js, TailwindCSS via CDN"
    - "Static files served from /static/"
    - "Capture images served from /captures/"
  artifacts:
    - path: "server/src/jarvis_server/web/routes.py"
      provides: "Web UI router with HTML page endpoints"
    - path: "server/src/jarvis_server/web/templates/base.html"
      provides: "Base HTML template"
---

<objective>
Set up web UI foundation with HTMX, Alpine.js, and TailwindCSS served from FastAPI.

No separate build process - everything serves directly from FastAPI using Jinja2 templates.
</objective>

<context>
@.planning/PROJECT.md
@server/src/jarvis_server/main.py
@server/src/jarvis_server/config.py
</context>

<tasks>

<task type="auto">
<name>Task 1: Add Jinja2 dependency</name>
<files>server/pyproject.toml</files>
<action>Add jinja2>=3.1.0 to dependencies</action>
<verify>pip install -e server/ && python -c "import jinja2"</verify>
<done>Jinja2 installed</done>
</task>

<task type="auto">
<name>Task 2: Create web module with routes</name>
<files>
server/src/jarvis_server/web/__init__.py
server/src/jarvis_server/web/routes.py
</files>
<action>
Create web router with page endpoints:
- GET / -> dashboard
- GET /timeline -> timeline page
- GET /search -> search page
- GET /calendar -> calendar page
- GET /settings -> settings page
</action>
<verify>python -c "from jarvis_server.web import router"</verify>
<done>Web router created</done>
</task>

<task type="auto">
<name>Task 3: Create base HTML template</name>
<files>server/src/jarvis_server/web/templates/base.html</files>
<action>
Create base.html with:
- TailwindCSS CDN
- HTMX CDN
- Alpine.js CDN
- Sidebar navigation
- Content block
</action>
<verify>ls server/src/jarvis_server/web/templates/base.html</verify>
<done>Base template created</done>
</task>

<task type="auto">
<name>Task 4: Create dashboard index page</name>
<files>server/src/jarvis_server/web/templates/index.html</files>
<action>
Dashboard with HTMX-loaded components:
- Stats cards (captures, events, storage)
- Upcoming meetings list
- Recent captures grid
</action>
<verify>ls server/src/jarvis_server/web/templates/index.html</verify>
<done>Dashboard page created</done>
</task>

<task type="auto">
<name>Task 5: Create stub pages for other routes</name>
<files>
server/src/jarvis_server/web/templates/timeline.html
server/src/jarvis_server/web/templates/search.html
server/src/jarvis_server/web/templates/calendar.html
server/src/jarvis_server/web/templates/settings.html
</files>
<action>Create minimal stub templates extending base.html</action>
<verify>ls server/src/jarvis_server/web/templates/*.html | wc -l</verify>
<done>All page templates created</done>
</task>

<task type="auto">
<name>Task 6: Create static CSS file</name>
<files>server/src/jarvis_server/web/static/css/custom.css</files>
<action>Custom CSS for HTMX indicators, capture thumbnails, timeline grid</action>
<verify>ls server/src/jarvis_server/web/static/css/custom.css</verify>
<done>Custom CSS created</done>
</task>

<task type="auto">
<name>Task 7: Mount web router and static files</name>
<files>server/src/jarvis_server/main.py</files>
<action>
Add to main.py:
- include_router(web_router)
- Mount /static for CSS/JS
- Mount /captures for screenshot images
</action>
<verify>python -c "from jarvis_server.main import app; print('/' in [r.path for r in app.routes if hasattr(r, 'path')])"</verify>
<done>Web router and static files mounted</done>
</task>

<task type="auto">
<name>Task 8: Create web API for dashboard HTMX fragments</name>
<files>
server/src/jarvis_server/web/api.py
server/src/jarvis_server/web/templates/partials/stats.html
server/src/jarvis_server/web/templates/partials/upcoming-meetings.html
server/src/jarvis_server/web/templates/partials/recent-captures.html
</files>
<action>
API endpoints returning HTML fragments:
- GET /api/web/stats
- GET /api/web/upcoming-meetings
- GET /api/web/recent-captures
</action>
<verify>python -c "from jarvis_server.web.api import router"</verify>
<done>Web API and partials created</done>
</task>

</tasks>

<verification>
1. Docker rebuild: docker compose build && docker compose up -d
2. curl http://localhost:8000/ returns HTML with "Jarvis"
3. curl http://localhost:8000/static/css/custom.css returns CSS
4. Navigation links work
</verification>

<success_criteria>
- Web UI accessible at /
- All page routes working
- Static files serving
- Dashboard loads with HTMX fragments
</success_criteria>

<commit_guidance>
feat(07-01): add web UI foundation with HTMX and Jinja2 templates
</commit_guidance>
