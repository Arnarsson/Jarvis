---
phase: 01-privacy-first-capture-foundation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - agent/pyproject.toml
  - agent/src/jarvis/__init__.py
  - agent/src/jarvis/config/__init__.py
  - agent/src/jarvis/config/settings.py
  - agent/src/jarvis/config/exclusions.yaml
  - agent/README.md
autonomous: true

must_haves:
  truths:
    - "Agent project can be installed with pip install -e ."
    - "Configuration can be loaded from environment variables and YAML files"
    - "Default exclusion list includes common password managers"
  artifacts:
    - path: "agent/pyproject.toml"
      provides: "Package definition with all dependencies"
      contains: "mss"
    - path: "agent/src/jarvis/config/settings.py"
      provides: "Pydantic settings model"
      contains: "class Settings"
    - path: "agent/src/jarvis/config/exclusions.yaml"
      provides: "Default exclusion rules"
      contains: "1password"
  key_links:
    - from: "agent/src/jarvis/config/settings.py"
      to: "pydantic_settings"
      via: "BaseSettings import"
      pattern: "from pydantic_settings import"
---

<objective>
Create the foundational project structure for the Jarvis desktop agent.

Purpose: Establishes the Python package layout, dependency management, and configuration system that all other agent modules will build upon.
Output: Installable Python package with pydantic-settings configuration and default exclusion list.
</objective>

<execution_context>
@/home/sven/.claude/get-shit-done/workflows/execute-plan.md
@/home/sven/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-privacy-first-capture-foundation/01-RESEARCH.md
@.planning/phases/01-privacy-first-capture-foundation/01-CONTEXT.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create agent project structure</name>
  <files>
    agent/pyproject.toml
    agent/src/jarvis/__init__.py
    agent/README.md
  </files>
  <action>
Create the agent project directory with modern Python packaging:

1. Create `agent/pyproject.toml` with:
   - Project name: jarvis-agent
   - Python 3.11+ requirement
   - Dependencies from research: mss, pystray, typer[all], imagehash, pywinctl, pynput, pillow, pytesseract, httpx, python-json-logger, pydantic-settings
   - Entry point: `jarvis = jarvis.cli:app`
   - Development dependencies: pytest, pytest-asyncio, ruff

2. Create `agent/src/jarvis/__init__.py` with version string `__version__ = "0.1.0"`

3. Create `agent/README.md` with brief description and installation instructions

Use src layout (src/jarvis/) for proper package isolation. Do NOT use flat layout.
  </action>
  <verify>
cd /home/sven/Documents/jarvis/agent && pip install -e . 2>&1 | grep -E "(Successfully|error)"
  </verify>
  <done>Package installs without errors, `jarvis --version` shows 0.1.0</done>
</task>

<task type="auto">
  <name>Task 2: Configuration module with exclusion rules</name>
  <files>
    agent/src/jarvis/config/__init__.py
    agent/src/jarvis/config/settings.py
    agent/src/jarvis/config/exclusions.yaml
  </files>
  <action>
Create the configuration system using pydantic-settings:

1. Create `agent/src/jarvis/config/settings.py`:
   - Class `Settings(BaseSettings)` with fields:
     - capture_interval: int = 15 (seconds)
     - idle_threshold: int = 300 (5 minutes in seconds)
     - jpeg_quality: int = 80
     - server_url: str = "http://localhost:8000"
     - exclusions_file: Path = Path("~/.config/jarvis/exclusions.yaml")
     - data_dir: Path = Path("~/.local/share/jarvis")
     - log_level: str = "INFO"
   - model_config with env_prefix="JARVIS_"
   - Method to load exclusions from YAML

2. Create `agent/src/jarvis/config/exclusions.yaml` with default exclusions:
   - app_names: ["1password", "bitwarden", "lastpass", "keepass", "keychain access", "gnome-keyring"]
   - window_titles: ["private browsing", "incognito", "inprivate"]
   - Comment explaining users can add banking apps

3. Create `agent/src/jarvis/config/__init__.py` exporting Settings and a `get_settings()` function with caching

Use PyYAML for loading exclusions. Add PyYAML to pyproject.toml dependencies if not already included.
  </action>
  <verify>
cd /home/sven/Documents/jarvis/agent && python -c "from jarvis.config import get_settings; s = get_settings(); print(f'interval={s.capture_interval}, idle={s.idle_threshold}')"
  </verify>
  <done>Settings load successfully with defaults, exclusions.yaml parsed correctly</done>
</task>

</tasks>

<verification>
After both tasks complete:
1. `cd agent && pip install -e .` succeeds
2. `python -c "from jarvis.config import get_settings; print(get_settings())"` shows all settings
3. `python -c "from jarvis.config.settings import Settings; s = Settings(); print(s.load_exclusions())"` returns exclusion dict
</verification>

<success_criteria>
- Agent package is pip-installable in editable mode
- Settings class loads from environment variables with JARVIS_ prefix
- Default exclusions include major password managers
- Project follows src layout convention
</success_criteria>

<output>
After completion, create `.planning/phases/01-privacy-first-capture-foundation/01-01-SUMMARY.md`
</output>
